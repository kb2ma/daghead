package router

import (
  "testing"
  "github.com/stretchr/testify/assert"
)


// 6LoRH RPI, I flag = 2, K flag = 1, senderRank = 2816
var data = []byte{
0xF1, 0x83, 0x05, 0x0B, 0x7A, 0x55, 0x3A, 0x82, 0x54, 0x7D,
0x13, 0x76, 0x65, 0x79, 0x78, 0x46, 0x1D, 0x52, 0x44, 0x7B,
0x43, 0x76, 0x78, 0x9B, 0x02, 0xE1, 0x08, 0x00, 0x40, 0x00,
0x01, 0xBB, 0xBB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46,
0x1D, 0x52, 0x44, 0x7B, 0x43, 0x76, 0x78, 0x06, 0x14, 0x00,
0x00, 0x00, 0xAA, 0xBB, 0xBB, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x46, 0x1D, 0x52, 0x44, 0x7B, 0x43, 0x76, 0x78, 0xB4, 0xD1,
}

func TestReadData(t *testing.T) {
	assert.Equal(t, 71, len(data))

	ipFields := ReadData(0x78, data)

	assert.Equal(t, 0, ipFields["hop_rplInstanceID"])
	assert.Equal(t, 2816, ipFields["hop_senderRank"])
	assert.Equal(t, 4, ipFields["payload"])
}


